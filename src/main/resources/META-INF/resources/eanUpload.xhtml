<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:sec="http://www.springframework.org/security/tags">
    <ui:composition template="layout.xhtml">
        <ui:define name="content">
            <style>
                .column1{
                    width: 50%;

                }
                .ui-growl-message {
                    width: 100% !important;
                }
            </style>
            <sec:authorize  access="hasRole('ROLE_ADMIN')">
                <div class="alert alert-light">
                    <strong>Pull the latest xlsx file from  souq-pricing/dolon-input , <i>the file is automatically processed every Monday at 8 PM</i></strong><br/>
                    <p:commandButton actionListener="#{eanUploadMB.processLatestS3bucketFile}" value="Process Latest S3 File" update=":form:msgs"/>
                </div>
            </sec:authorize>

            <div class="alert alert-light">
                <strong>Please follow the following steps to import sheet into dolon</strong>
                <ul>
                    <li>Click on "Download template" and fill the template</li>
                    <li>Click on "Choose Excel (.xlsx only) sheet" and select the template you filled with xlsx format</li>
                    <li>Click on "Import File" and wait until a success message appears </li>
                    <li><strong>Please note that a report showing errors in your sheet will appear if we found any errors in your sheet , fix them then re-do the steps, <i>You can download the report by clicking on "Download report"</i></strong></li>
                </ul>
            </div>



            <h:form id="form" enctype="multipart/form-data">
                <p:growl id="msgs" showDetail="true" sticky="true"/>
                <p:panelGrid columns="2" style="width: 100%" columnClasses="column1,column1">

                    <h:outputLabel rendered="false" value="set all records as VALIDATED"/>



                </p:panelGrid>
                <ol>
                    <li>
                        <div class="alert alert-light">
                            <a href="/download-import-template" >Download template</a>
                        </div>
                    </li>
                    <li>

                        <p:fileUpload label="Choose Excel (.xlsx only) sheet" fileUploadListener="#{eanUploadMB.upload}" auto="true" update=":form:filenameField" multiple="false"  allowTypes="/(\.|\/)(xlsx)$/">
                            <b><i><h:outputText id="filenameField" value=" #{eanUploadMB.fileName}" /></i></b>
                        </p:fileUpload>
                        <br/>
                    </li>
                    <li>

                        <p:commandButton actionListener="#{eanUploadMB.processFile}" value="Import File" update=":form:msgs form"/>

                    </li>
                </ol>


                <br/>


            </h:form>

        </ui:define>
    </ui:composition>
</html>
